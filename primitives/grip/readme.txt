The common sense in the code is:

vector is saved in column-first style: 
for example, [p1;p2;p3];
points are saved in row-first style:
for example, [[v11,v12,v13];[v21,v22,v23]];